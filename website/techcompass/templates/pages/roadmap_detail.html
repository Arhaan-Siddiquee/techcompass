<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
</head>
<body>
    {% if not_registered %}
    <a href="{% url 'techcompass:frontend' %}" class="btn btn-outline-info mx-4 px-3 fs-5">Start your journey</a>
        <h1>LOL Not registered</h1>
        {{roadmap.title}}
    {% else %}
        <h1>LOL Registered</h1>
        {{roadmap.title}}
        {{roadmap.description | safe}}
        <img src="{{media_url}}{{roadmap.badge}}" alt="badge" height="300px">
        
        {% for course in courses %}
            <h1>{{course.title}}</h1>
            <p>{{course.description}}</p>
            
            {% if course in completed_courses %}
                <input class="form-check-input bg-info course_toggle" type="checkbox" value="" id="flexCheckDefault" data-from="{{course.title}}"  checked>
                
            {% else %}
                <input class="form-check-input bg-info course_toggle" type="checkbox" value="" id="flexCheckDefault" data-from="{{course.title}}">
                <br>kjjjnun 
            {% endif %}
                
            
            
            {% for video in course.videos %}
                {{video.0}}
                {{video.1}}
            {% endfor %}
                
           
        {% endfor %}
            

    {% endif %}
        
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const course_toggle = document.querySelectorAll('.course_toggle');
            course_toggle.forEach((toggle) => {
                toggle.addEventListener('change', function() {
                    const course_title = this.getAttribute('data-from');
                    console.log(course_title,"{{roadmap.id}}","{{csrf_token}}");
                    const is_checked = this.checked;
                    console.log(course_title, is_checked);
                    if (is_checked) {
                        fetch(`{% url 'techcompass:course_update' %}`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': '{{csrf_token}}'
                            },
                            body: JSON.stringify({
                                course_title: course_title,
                                is_checked: is_checked,
                                roadmap_id: "{{roadmap.id}}",

                            })
                        })
                        .then(response => response.json())
                        .then(data => {
                            console.log(data);
                        });
                    } else {
                        fetch(`{% url 'techcompass:course_update' %}`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': '{{csrf_token}}'
                            },
                            body: JSON.stringify({
                                course_title: course_title,
                                is_checked: is_checked,
                                roadmap_id: "{{roadmap.id}}"
                            })
                        })
                        .then(response => response.json())
                        .then(data => {
                            console.log(data);
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>